<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Python routes</title>
  <meta property="og:title" content="Python routes" />
  <meta name="twitter:title" content="Python routes" />
  <meta name="description" content="Ruotes简介

Routes解决了一个Web开发中经常遇到的问题，那就是怎么将url请求map到app，也就是，你怎么能说&rsquo;/blog/2008/01/08&rsquo;做这件事，而&rsquo;/login&rsquo;却做另外一个。许多Web框架都有一个内置的调度系统。比如，&rsquo;/A/B/C&rsquo;表示在目录B中读文件C，或者在&rsquo;A.B&rsquo;模块中调用B类的C方法。这样看，毫无问题。但是，当你要重新组织urls的时候，改动就会很大。

Routes却另辟蹊径。它将url层次和action分离，你可以按照你想要的方式去连接它们。如果你要改变一个特定的url，只要改变route map的一行代码，而不用改变action的逻辑。甚至你可以将多个url指向相同的action。Routes最早起源于Ruby on Rails，到现在已经有很大的不同了。

Ruotes是Pylons框架最初的调度系统，也是CherrPy的一种调度。所有的Web框架都能用它来处理整个url架构或者是url的subtree。它也可以将subtree指向其他的调度，TurboGear 2在Pylons就是这么实现的。

">
  <meta property="og:description" content="Ruotes简介

Routes解决了一个Web开发中经常遇到的问题，那就是怎么将url请求map到app，也就是，你怎么能说&rsquo;/blog/2008/01/08&rsquo;做这件事，而&rsquo;/login&rsquo;却做另外一个。许多Web框架都有一个内置的调度系统。比如，&rsquo;/A/B/C&rsquo;表示在目录B中读文件C，或者在&rsquo;A.B&rsquo;模块中调用B类的C方法。这样看，毫无问题。但是，当你要重新组织urls的时候，改动就会很大。

Routes却另辟蹊径。它将url层次和action分离，你可以按照你想要的方式去连接它们。如果你要改变一个特定的url，只要改变route map的一行代码，而不用改变action的逻辑。甚至你可以将多个url指向相同的action。Routes最早起源于Ruby on Rails，到现在已经有很大的不同了。

Ruotes是Pylons框架最初的调度系统，也是CherrPy的一种调度。所有的Web框架都能用它来处理整个url架构或者是url的subtree。它也可以将subtree指向其他的调度，TurboGear 2在Pylons就是这么实现的。

">
  <meta name="twitter:description" content="Ruotes简介

Routes解决了一个Web开发中经常遇到的问题，那就是怎么将url请求map到app，也就是，你怎么能说&rsquo;/blog/2008/01/08&rsquo;做这件事，而&rsquo;/login&rsquo;却做另外一个。许多Web框架都有一个内置的调度系统。比如，&rsquo;/A/B/C&rsquo;表示在目录B中读文件C，或者在&rsquo;A.B&rsquo; …">
  <meta name="author" content=""/>
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="/post/python-routes/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Yung Sung" />

  <meta name="generator" content="Hugo 0.21" />
  <link rel="canonical" href="/post/python-routes/" />
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Yung Sung">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="/css/pygment_highlights.css" />
  <link rel="stylesheet" href="/css/highlight.min.css" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Yung Sung</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="About" href="/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>Python routes</h1>
                
                
                  <span class="post-meta">
  Posted on April 8, 2015
  
</span>


                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <h2 id="ruotes简介">Ruotes简介</h2>

<p>Routes解决了一个Web开发中经常遇到的问题，那就是怎么将url请求map到app，也就是，你怎么能说&rsquo;/blog/2008/01/08&rsquo;做这件事，而&rsquo;/login&rsquo;却做另外一个。许多Web框架都有一个内置的调度系统。比如，&rsquo;/A/B/C&rsquo;表示在目录B中读文件C，或者在&rsquo;A.B&rsquo;模块中调用B类的C方法。这样看，毫无问题。但是，当你要重新组织urls的时候，改动就会很大。</p>

<p>Routes却另辟蹊径。它将url层次和action分离，你可以按照你想要的方式去连接它们。如果你要改变一个特定的url，只要改变route map的一行代码，而不用改变action的逻辑。甚至你可以将多个url指向相同的action。Routes最早起源于Ruby on Rails，到现在已经有很大的不同了。</p>

<p>Ruotes是Pylons框架最初的调度系统，也是CherrPy的一种调度。所有的Web框架都能用它来处理整个url架构或者是url的subtree。它也可以将subtree指向其他的调度，TurboGear 2在Pylons就是这么实现的。</p>

<p></p>

<h2 id="搭建routes">搭建Routes</h2>

<p>Routes安装可以用pip或者easy_insatll，也可以下载源码用python setup.py install安装。</p>

<p>Pylons中，在myapp/config/routing.py模块的make_map函数中定义routes，下面是一个典型的配置：</p>

<pre><code class="language-python">from routes import Mapper
map = Mapper()
map.connect(None, &quot;/error/{action}/{id}&quot;, controller=&quot;error&quot;)
map.connect(&quot;home&quot;, &quot;/&quot;, controller=&quot;main&quot;, action=&quot;index&quot;)
# ADD CUSTOM ROUTES HERE
map.connect(None, &quot;/{controller}/{action}&quot;)
map.connect(None, &quot;/{controller}/{action}/{id}&quot;)
</code></pre>

<p>第1行和第2行创建一个mapper。</p>

<p>第3行匹配以&rsquo;/error&rsquo;开头的三层url，将controller参数设置成常量。url请求&rsquo;/error/images/arrow.jpg&rsquo;会产生：</p>

<pre><code class="language-python">{&quot;controller&quot;: &quot;error&quot;, &quot;action&quot;: &quot;images&quot;, &quot;id&quot;: &quot;arrow.jpg&quot;}
</code></pre>

<p>第4行匹配&rsquo;/&lsquo;, controller和action参数都设置成了常量，还有route名称&rsquo;home&rsquo;，它可以用来生成url。（其他route用None代替name。建议生成url的route都命名，其他route没有必要。）</p>

<p>第6行匹配任意的两层url，第7行匹配任意三层url。当我们不想为每个action都定义不同的route时，这么做是很有用的。当然，如果你为每个action都定义了route，就可以删掉这两行了。</p>

<p>注意，&rsquo;/error/images/arrow.jpg&rsquo;可以匹配第3行和第7行。mapper是按顺序匹配，所以这个url匹配第3行。</p>

<p>如果没有route能匹配url，mapper会返回&rsquo;matach failed&rsquo;，在Pylons就是&rsquo;404 Not Found&rsquo;。</p>

<p>Route path必须以&rsquo;/&lsquo;开头。</p>

<h3 id="requirements">Requirements</h3>

<p>Route path可以使用正则表达式。有两种方式：一是行内，二是使用requirements参数。</p>

<pre><code class="language-python">map.connect(R&quot;/blog/{id:\d+}&quot;)
map.connect(R&quot;/download/{platform:windows|mac}/{filename}&quot;)
</code></pre>

<p>等同于：</p>

<pre><code class="language-python">map.connect(&quot;/blog/{id}&quot;, requirements={&quot;id&quot;: R&quot;\d+&quot;}
map.connect(&quot;/download/{platform}/{filename}&quot;,
    requirements={&quot;platform&quot;: R&quot;windows|mac&quot;})
</code></pre>

<p>为了包含&rsquo;\&lsquo;，正则表达式使用了R&rdquo;&ldquo;。如果不用R，就要使用&rsquo;\&lsquo;。</p>

<pre><code class="language-python">m.connect(&quot;archives/{year}/{month}/{day}&quot;, controller=&quot;archives&quot;,
          action=&quot;view&quot;, year=2004,
          requirements=dict(year=R&quot;\d{2,4}&quot;, month=R&quot;\d{1,2}&quot;))

NUMERIC = R&quot;\d+&quot;
map.connect(..., requirements={&quot;id&quot;: NUMERIC})

ARTICLE_REQS = {&quot;year&quot;: R&quot;\d\d\d\d&quot;, &quot;month&quot;: R&quot;\d\d&quot;, &quot;day&quot;: R&quot;\d\d&quot;}
map.connect(..., requirements=ARTICLE_REQS)
</code></pre>

<h3 id="conditions">Conditions</h3>

<p>Conditions决定匹配何种请求。conditions参数是一个字典，有三个key：</p>

<p>method</p>

<p>大写的HTTP方法列表，请求的方法必须是其中某一种。</p>

<p>sub_domain</p>

<p>可以是subdomain列表，True，False或者None。如果是列表，请求必须调用列表中的subdomain。如果是True，请求必须包括任意一个subdomain。如果是False或者None，不匹配subdomain。</p>

<p>function</p>

<p>验证request的函数。它必须是func(envirion, match_dict) =&gt; bool这种类型。如果匹配成功返回True，否则返回False。第一个参数是WSGI环境变量，第二个参数是匹配成功后返回的变量。函数还可以改变mtach。</p>

<p>例子：</p>

<pre><code class="language-python"># Match only if the HTTP method is &quot;GET&quot; or &quot;HEAD&quot;.
m.connect(&quot;/user/list&quot;, controller=&quot;user&quot;, action=&quot;list&quot;,
          conditions=dict(method=[&quot;GET&quot;, &quot;HEAD&quot;]))

# A sub-domain should be present.
m.connect(&quot;/&quot;, controller=&quot;user&quot;, action=&quot;home&quot;,
          conditions=dict(sub_domain=True))

# Sub-domain should be either &quot;fred&quot; or &quot;george&quot;.
m.connect(&quot;/&quot;, controller=&quot;user&quot;, action=&quot;home&quot;,
          conditions=dict(sub_domain=[&quot;fred&quot;, &quot;george&quot;]))

# Put the referrer into the resulting match dictionary.
# This function always returns true, so it never prevents the match
# from succeeding.
def referals(environ, result):
    result[&quot;referer&quot;] = environ.get(&quot;HTTP_REFERER&quot;)
    return True
m.connect(&quot;/{controller}/{action}/{id}&quot;,
    conditions=dict(function=referals))
</code></pre>

<h3 id="wildcard-routes">Wildcard routes</h3>

<p>path变量默认情况不匹配&rsquo;/&lsquo;。这是为了保证每个path精确匹配某一层url。你可以用requirements去覆盖：</p>

<pre><code class="language-python">map.connect(&quot;/static/{filename:.*?}&quot;)
</code></pre>

<p>匹配&rsquo;/static/foo.jpg&rsquo;，&rsquo;/static/bar/foo.jpg&rsquo;等url。</p>

<h3 id="format-extensions">Format extensions</h3>

<p>path中包含&rsquo;{.format}&lsquo;会匹配可选的扩展名（如.html或者.json），在&rsquo;.&lsquo;之后设置format变量。例如：</p>

<pre><code class="language-python">map.connect('/entries/{id}{.format}')
</code></pre>

<p>匹配&rsquo;/entries/1&rsquo;和&rsquo;/entires/1.mp3&rsquo;。你可以用requirements去限制匹配的扩展名：</p>

<pre><code class="language-python">map.connect('/entries/{id:\d+}{.format:json}')
</code></pre>

<p>匹配&rsquo;/entries/1&rsquo;和&rsquo;/entires/1.json&rsquo;，但是不匹配&rsquo;/entires/1.mp3&rsquo;。</p>

<h3 id="submappers">Submappers</h3>

<p>如果有相同的Key-value参数，可以用Submapper来添加route。有两种语法，一个使用<code>with</code>，一个不用：</p>

<pre><code class="language-python"># Using 'with'
with map.submapper(controller=&quot;home&quot;) as m:
    m.connect(&quot;home&quot;, &quot;/&quot;, action=&quot;splash&quot;)
    m.connect(&quot;index&quot;, &quot;/index&quot;, action=&quot;index&quot;)

# Not using 'with'
m = map.submapper(controller=&quot;home&quot;)
m.connect(&quot;home&quot;, &quot;/&quot;, action=&quot;splash&quot;)
m.connect(&quot;index&quot;, &quot;/index&quot;, action=&quot;index&quot;)

# Both of these syntaxes create the following routes::
# &quot;/&quot;      =&gt; {&quot;controller&quot;: &quot;home&quot;, action=&quot;splash&quot;}
# &quot;/index&quot; =&gt; {&quot;controller&quot;: &quot;home&quot;, action=&quot;index&quot;}
</code></pre>

<p>可以使用<code>path_prefix</code>参数：</p>

<pre><code class="language-python">with map.submapper(path_prefix=&quot;/admin&quot;, controller=&quot;admin&quot;) as m:
    m.connect(&quot;admin_users&quot;, &quot;/users&quot;, action=&quot;users&quot;)
    m.connect(&quot;admin_databases&quot;, &quot;/databases&quot;, action=&quot;databases&quot;)

# /admin/users     =&gt; {&quot;controller&quot;: &quot;admin&quot;, &quot;action&quot;: &quot;users&quot;}
# /admin/databases =&gt; {&quot;controller&quot;: &quot;admin&quot;, &quot;action&quot;: &quot;databases&quot;}
</code></pre>

<p><code>.submapper</code>的参数必须是key-value。</p>

<h3 id="submapper-helpers">Submapper helpers</h3>

<pre><code class="language-python">with map.submapper(controller=&quot;home&quot;) as m:
    m.connect(&quot;home&quot;, &quot;/&quot;, action=&quot;splash&quot;)
    m.connect(&quot;index&quot;, &quot;/index&quot;, action=&quot;index&quot;)
</code></pre>

<p>可以写成：</p>

<pre><code class="language-python">with map.submapper(controller=&quot;home&quot;, path_prefix=&quot;/&quot;) as m:
    m.action(&quot;home&quot;, action=&quot;splash&quot;)
    m.link(&quot;index&quot;)
</code></pre>

<p><code>action</code>在submapper的path（上例中是&rsquo;/&lsquo;）上生成route。而<code>link</code>根据相关的path生成route。</p>

<p>还有一些其他的action，<code>index</code>，<code>new</code>，<code>create</code>，<code>show</code>，<code>edit</code>，<code>update</code>和<code>delete</code>。</p>

<pre><code class="language-python">with map.submapper(controller=&quot;entries&quot;, path_prefix=&quot;/entries&quot;) as entries:
    entries.index()
    with entries.submapper(path_prefix=&quot;/{id}&quot;) as entry:
        entry.show()
</code></pre>

<pre><code class="language-python">with map.submapper(controller=&quot;entries&quot;, path_prefix=&quot;/entries&quot;,
                   actions=[&quot;index&quot;]) as entries:
    entries.submapper(path_prefix=&quot;/{id}&quot;, actions=[&quot;show&quot;])
</code></pre>

<pre><code class="language-python">map.collection(collection_name=&quot;entries&quot;, member_name=&quot;entry&quot;,
               controller=&quot;entries&quot;,
               collection_actions=[&quot;index&quot;], member_actions[&quot;show&quot;])
</code></pre>

<h2 id="restful-services">RESTful services</h2>

<p>map.resource使Restful风格的url更加容易，它创建了一个&rsquo;add/modify/delete&rsquo;route集。</p>

<pre><code class="language-python">map.resource(&quot;message&quot;, &quot;messages&quot;)

# The above command sets up several routes as if you had typed the
# following commands:
map.connect(&quot;messages&quot;, &quot;/messages&quot;,
    controller=&quot;messages&quot;, action=&quot;create&quot;,
    conditions=dict(method=[&quot;POST&quot;]))
map.connect(&quot;messages&quot;, &quot;/messages&quot;,
    controller=&quot;messages&quot;, action=&quot;index&quot;,
    conditions=dict(method=[&quot;GET&quot;]))
map.connect(&quot;formatted_messages&quot;, &quot;/messages.{format}&quot;,
    controller=&quot;messages&quot;, action=&quot;index&quot;,
    conditions=dict(method=[&quot;GET&quot;]))
map.connect(&quot;new_message&quot;, &quot;/messages/new&quot;,
    controller=&quot;messages&quot;, action=&quot;new&quot;,
    conditions=dict(method=[&quot;GET&quot;]))
map.connect(&quot;formatted_new_message&quot;, &quot;/messages/new.{format}&quot;,
    controller=&quot;messages&quot;, action=&quot;new&quot;,
    conditions=dict(method=[&quot;GET&quot;]))
map.connect(&quot;/messages/{id}&quot;,
    controller=&quot;messages&quot;, action=&quot;update&quot;,
    conditions=dict(method=[&quot;PUT&quot;]))
map.connect(&quot;/messages/{id}&quot;,
    controller=&quot;messages&quot;, action=&quot;delete&quot;,
    conditions=dict(method=[&quot;DELETE&quot;]))
map.connect(&quot;edit_message&quot;, &quot;/messages/{id}/edit&quot;,
    controller=&quot;messages&quot;, action=&quot;edit&quot;,
    conditions=dict(method=[&quot;GET&quot;]))
map.connect(&quot;formatted_edit_message&quot;, &quot;/messages/{id}.{format}/edit&quot;,
    controller=&quot;messages&quot;, action=&quot;edit&quot;,
    conditions=dict(method=[&quot;GET&quot;]))
map.connect(&quot;message&quot;, &quot;/messages/{id}&quot;,
    controller=&quot;messages&quot;, action=&quot;show&quot;,
    conditions=dict(method=[&quot;GET&quot;]))
map.connect(&quot;formatted_message&quot;, &quot;/messages/{id}.{format}&quot;,
    controller=&quot;messages&quot;, action=&quot;show&quot;,
    conditions=dict(method=[&quot;GET&quot;]))
</code></pre>

<pre><code class="language-python">GET    /messages        =&gt; messages.index()    =&gt; url(&quot;messages&quot;)
POST   /messages        =&gt; messages.create()   =&gt; url(&quot;messages&quot;)
GET    /messages/new    =&gt; messages.new()      =&gt; url(&quot;new_message&quot;)
PUT    /messages/1      =&gt; messages.update(id) =&gt; url(&quot;message&quot;, id=1)
DELETE /messages/1      =&gt; messages.delete(id) =&gt; url(&quot;message&quot;, id=1)
GET    /messages/1      =&gt; messages.show(id)   =&gt; url(&quot;message&quot;, id=1)
GET    /messages/1/edit =&gt; messages.edit(id)   =&gt; url(&quot;edit_message&quot;, id=1)
</code></pre>

<h3 id="resource-options">Resource options</h3>

<p>controller</p>

<p>collection</p>

<pre><code class="language-python">map.resource(&quot;message&quot;, &quot;messages&quot;, collection={&quot;rss&quot;: &quot;GET&quot;})
# &quot;GET /messages/rss&quot;  =&gt;  ``Messages.rss()``.
# Defines a named route &quot;rss_messages&quot;.
</code></pre>

<p>member</p>

<pre><code class="language-python">map.resource('message', 'messages', member={'mark':'POST'})
# &quot;POST /message/1/mark&quot;  =&gt;  ``Messages.mark(1)``
# also adds named route &quot;mark_message&quot;

map.resource(&quot;message&quot;, &quot;messages&quot;, member={&quot;ask_delete&quot;: &quot;GET&quot;}
# &quot;GET /message/1/ask_delete&quot;   =&gt;   ``Messages.ask_delete(1)``.
# Also adds a named route &quot;ask_delete_message&quot;.
</code></pre>

<p>new</p>

<pre><code class="language-python">map.resource(&quot;message&quot;, &quot;messages&quot;, new={&quot;preview&quot;: &quot;POST&quot;})
# &quot;POST /messages/new/preview&quot;
</code></pre>

<p>path_prefix</p>

<p>所有url的前置。</p>

<p>name_prefix</p>

<pre><code class="language-python">map.resource(&quot;message&quot;, &quot;messages&quot;, controller=&quot;categories&quot;,
    path_prefix=&quot;/category/{category_id}&quot;,
    name_prefix=&quot;category_&quot;)
# GET /category/7/message/1
# Adds named route &quot;category_message&quot;
</code></pre>

<p>parent_resource</p>

<p>一个包含父resource信息的字典，在创建嵌套resource使用。它应该包含member_name和collection_name。</p>

<p>如果指定parent_resource而没有path_prefix，path_prefix将用&rsquo;&lt;parent collection name&gt;/:&lt;parent member name&gt;_id&rsquo;生成。</p>

<p>如果指定parent_resource而没有name_prefix，name_prefix将用&rsquo;&lt;parent member name&gt;_&lsquo;生成。</p>

<pre><code class="language-python">&gt;&gt;&gt; m = Mapper()
&gt;&gt;&gt; m.resource('location', 'locations',
...            parent_resource=dict(member_name='region',
...                                 collection_name='regions'))
&gt;&gt;&gt; # path_prefix is &quot;regions/:region_id&quot;
&gt;&gt;&gt; # name prefix is &quot;region_&quot;
&gt;&gt;&gt; url('region_locations', region_id=13)
'/regions/13/locations'
&gt;&gt;&gt; url('region_new_location', region_id=13)
'/regions/13/locations/new'
&gt;&gt;&gt; url('region_location', region_id=13, id=60)
'/regions/13/locations/60'
&gt;&gt;&gt; url('region_edit_location', region_id=13, id=60)
'/regions/13/locations/60/edit'

Overriding generated path_prefix:

&gt;&gt;&gt; m = Mapper()
&gt;&gt;&gt; m.resource('location', 'locations',
...            parent_resource=dict(member_name='region',
...                                 collection_name='regions'),
...            path_prefix='areas/:area_id')
&gt;&gt;&gt; # name prefix is &quot;region_&quot;
&gt;&gt;&gt; url('region_locations', area_id=51)
'/areas/51/locations'

Overriding generated name_prefix:

&gt;&gt;&gt; m = Mapper()
&gt;&gt;&gt; m.resource('location', 'locations',
...            parent_resource=dict(member_name='region',
...                                 collection_name='regions'),
...            name_prefix='')
&gt;&gt;&gt; # path_prefix is &quot;regions/:region_id&quot;
&gt;&gt;&gt; url('locations', region_id=51)
'/regions/51/locations'
</code></pre>
      </article>

      <ul class="pager blog-pager">
        
          <li class="previous">
            <a href="/post/pg-subprocess/" data-toggle="tooltip" data-placement="top" title="Postgresql子进程启动">&larr; Previous Post</a>
          </li>
        
        
          <li class="next">
            <a href="/post/pgpool/" data-toggle="tooltip" data-placement="top" title="使用pgpool&#43;流复制搭建Postgresql高可用环境">Next Post &rarr;</a>
          </li>
        
      </ul>

      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:sunyu418@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/syfun" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
          &nbsp;&bull;&nbsp;
          2017

          
            &nbsp;&bull;&nbsp;
            <a href="/">Yung Sung</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.21</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/js/main.js"></script>
<script src="/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="/js/load-photoswipe.js"></script>



  </body>
</html>

